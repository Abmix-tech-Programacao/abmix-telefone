<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abmix - Sistema de Discagem Inteligente</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'abmix-green': '#9EFF00',
                        'dark-bg': '#0F0F0F',
                        'dark-surface': '#1A1A1A',
                        'dark-border': '#333333',
                    },
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    }
                }
            }
        };
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-dark-bg text-white font-inter min-h-screen">
    <!-- @COMPONENT: AppContainer -->
    <div class="flex h-screen overflow-hidden">
        
        <!-- @COMPONENT: Sidebar -->
        <div class="w-64 bg-dark-surface border-r border-dark-border flex-shrink-0">
            <!-- Logo -->
            <div class="p-6 border-b border-dark-border">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-abmix-green to-green-400 flex items-center justify-center">
                        <i class="fas fa-phone text-black text-sm"></i>
                    </div>
                    <h1 class="text-xl font-bold text-abmix-green">Abmix</h1>
                </div>
                <p class="text-sm text-gray-400 mt-1">Sistema de Discagem</p>
            </div>

            <!-- Navigation -->
            <nav class="p-4 space-y-2">
                <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg bg-abmix-green/10 text-abmix-green">
                    <i class="fas fa-phone-alt w-4"></i>
                    <span class="font-medium">Discagem</span>
                </a>
                <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-dark-border transition-colors text-gray-300">
                    <i class="fas fa-star w-4"></i>
                    <span>Favoritos</span>
                </a>
                <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-dark-border transition-colors text-gray-300">
                    <i class="fas fa-microphone w-4"></i>
                    <span>Gravações</span>
                </a>
                <a href="#" class="flex items-center space-x-3 px-3 py-2 rounded-lg hover:bg-dark-border transition-colors text-gray-300">
                    <i class="fas fa-cog w-4"></i>
                    <span>Configurações</span>
                </a>
            </nav>

            <!-- Provider Status -->
            <div class="absolute bottom-4 left-4 right-4">
                <div class="bg-dark-border/50 rounded-lg p-3">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-400">Provider</span>
                        <div class="flex items-center space-x-2">
                            <div class="w-2 h-2 bg-abmix-green rounded-full"></div>
                            <span class="text-sm text-white" data-bind="selectedProvider">Vapi</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- @COMPONENT: MainContent -->
        <div class="flex-1 flex flex-col overflow-hidden">
            
            <!-- @COMPONENT: Header -->
            <header class="bg-dark-surface border-b border-dark-border px-6 py-4">
                <div class="flex items-center justify-between">
                    <!-- Call Status -->
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center space-x-3">
                            <div class="w-3 h-3 bg-gray-500 rounded-full" data-bind="callStatus" id="status-indicator"></div>
                            <span class="text-lg font-semibold" data-bind="callState">Idle</span>
                        </div>
                        <div class="text-sm text-gray-400">
                            Latência: <span data-bind="latency" class="text-abmix-green">-- ms</span>
                        </div>
                    </div>

                    <!-- Audio Indicator -->
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-microphone text-gray-400"></i>
                            <div class="w-16 h-2 bg-dark-border rounded-full overflow-hidden">
                                <div class="h-full bg-abmix-green w-0 transition-all duration-150" id="audio-level"></div>
                            </div>
                        </div>
                        <button class="p-2 hover:bg-dark-border rounded-lg transition-colors">
                            <i class="fas fa-volume-up text-gray-400"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- @COMPONENT: MainGrid -->
            <div class="flex-1 overflow-hidden">
                <div class="h-full grid grid-cols-1 lg:grid-cols-3 gap-6 p-6">
                    
                    <!-- Left Column -->
                    <div class="space-y-6">
                        
                        <!-- @COMPONENT: DialerCard -->
                        <div class="bg-dark-surface rounded-xl p-6 border border-dark-border">
                            <h3 class="text-lg font-semibold mb-4">Discagem</h3>
                            
                            <!-- Number Input -->
                            <div class="mb-4">
                                <label class="block text-sm text-gray-400 mb-2">Número (E.164)</label>
                                <input 
                                    type="text" 
                                    placeholder="+5511999999999"
                                    class="w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-3 focus:border-abmix-green focus:outline-none transition-colors font-mono"
                                    data-bind="phoneNumber"
                                    data-mock="true"
                                >
                            </div>

                            <!-- Action Buttons -->
                            <div class="grid grid-cols-3 gap-3">
                                <button 
                                    class="bg-abmix-green text-black font-semibold py-3 rounded-lg hover:bg-abmix-green/90 transition-colors flex items-center justify-center"
                                    data-event="click:handleDial"
                                >
                                    <i class="fas fa-phone mr-2"></i>
                                    Discar
                                </button>
                                <button 
                                    class="bg-green-600 text-white font-semibold py-3 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center disabled:opacity-50"
                                    data-event="click:handleAnswer"
                                    disabled
                                >
                                    <i class="fas fa-phone mr-2"></i>
                                    Atender
                                </button>
                                <button 
                                    class="bg-red-600 text-white font-semibold py-3 rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center"
                                    data-event="click:handleHangup"
                                >
                                    <i class="fas fa-phone-slash mr-2"></i>
                                    Encerrar
                                </button>
                            </div>
                        </div>

                        <!-- @COMPONENT: AgentControls -->
                        <div class="bg-dark-surface rounded-xl p-6 border border-dark-border">
                            <h3 class="text-lg font-semibold mb-4">Controle de IA</h3>
                            
                            <div class="space-y-4">
                                <!-- AI Toggle -->
                                <div class="flex items-center justify-between">
                                    <span class="font-medium">IA Ativa</span>
                                    <div class="relative">
                                        <input type="checkbox" id="ai-toggle" class="sr-only" data-bind="aiActive">
                                        <div class="w-12 h-6 bg-dark-border rounded-full cursor-pointer transition-colors" onclick="toggleAI()">
                                            <div class="w-5 h-5 bg-white rounded-full transform transition-transform translate-x-0.5 translate-y-0.5" id="ai-toggle-handle"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Control Buttons -->
                                <div class="grid grid-cols-2 gap-3">
                                    <button class="bg-orange-600 text-white py-2 rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium" data-event="click:handleTakeControl">
                                        <i class="fas fa-user mr-2"></i>
                                        Assumir
                                    </button>
                                    <button class="bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium" data-event="click:handleResumeAI">
                                        <i class="fas fa-robot mr-2"></i>
                                        Retomar IA
                                    </button>
                                    <button class="bg-yellow-600 text-white py-2 rounded-lg hover:bg-yellow-700 transition-colors text-sm font-medium" data-event="click:handlePauseSpeech">
                                        <i class="fas fa-pause mr-2"></i>
                                        Pausar Fala
                                    </button>
                                    <button class="bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition-colors text-sm font-medium" data-event="click:handleResumeSpeech">
                                        <i class="fas fa-play mr-2"></i>
                                        Retomar Fala
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- @COMPONENT: CallControls -->
                        <div class="bg-dark-surface rounded-xl p-6 border border-dark-border">
                            <h3 class="text-lg font-semibold mb-4">Controles Avançados</h3>
                            
                            <div class="space-y-4">
                                <!-- Transfer & Hold -->
                                <div class="grid grid-cols-2 gap-3">
                                    <button class="bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium" data-event="click:handleTransfer">
                                        <i class="fas fa-exchange-alt mr-2"></i>
                                        Transferir
                                    </button>
                                    <button class="bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium" data-event="click:handleHold">
                                        <i class="fas fa-pause-circle mr-2"></i>
                                        Hold
                                    </button>
                                </div>

                                <!-- DTMF Pad -->
                                <div>
                                    <label class="block text-sm text-gray-400 mb-2">DTMF</label>
                                    <div class="grid grid-cols-3 gap-2">
                                        <!-- @MAP: ['1','2','3','4','5','6','7','8','9','*','0','#'].map(tone => ( -->
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="1">1</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="2">2</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="3">3</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="4">4</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="5">5</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="6">6</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="7">7</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="8">8</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="9">9</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="*">*</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="0">0</button>
                                        <button class="bg-dark-bg border border-dark-border hover:bg-dark-border transition-colors py-2 rounded text-sm font-mono" data-event="click:sendDTMF" data-tone="#">#</button>
                                        <!-- @END_MAP -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Middle Column -->
                    <div class="space-y-6">
                        
                        <!-- @COMPONENT: LivePrompt -->
                        <div class="bg-dark-surface rounded-xl p-6 border border-dark-border">
                            <h3 class="text-lg font-semibold mb-4">Prompt Ao Vivo</h3>
                            
                            <div class="space-y-4">
                                <textarea 
                                    placeholder="Digite instruções para a IA (ex: Mude o tom para mais formal, mencione a promoção especial...)"
                                    class="w-full bg-dark-bg border border-dark-border rounded-lg px-4 py-3 h-24 resize-none focus:border-abmix-green focus:outline-none transition-colors"
                                    data-bind="livePrompt"
                                    data-mock="true"
                                ></textarea>
                                
                                <button class="w-full bg-abmix-green text-black font-semibold py-3 rounded-lg hover:bg-abmix-green/90 transition-colors" data-event="click:handleApplyPrompt">
                                    <i class="fas fa-magic mr-2"></i>
                                    Aplicar Prompt
                                </button>
                            </div>
                        </div>

                        <!-- @COMPONENT: Favorites -->
                        <div class="bg-dark-surface rounded-xl p-6 border border-dark-border">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Favoritos</h3>
                                <button class="bg-abmix-green text-black p-2 rounded-lg hover:bg-abmix-green/90 transition-colors" data-event="click:handleAddFavorite">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>

                            <div class="space-y-3">
                                <!-- @MAP: favorites.map(favorite => ( -->
                                <div class="bg-dark-bg rounded-lg p-4 border border-dark-border" data-mock="true">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="font-semibold" data-bind="favorite.name">Suporte Técnico</h4>
                                            <p class="text-sm text-gray-400 font-mono" data-bind="favorite.number">+5511999887766</p>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <button class="text-abmix-green hover:bg-abmix-green/10 p-2 rounded transition-colors" data-event="click:dialFavorite">
                                                <i class="fas fa-phone"></i>
                                            </button>
                                            <button class="text-blue-400 hover:bg-blue-400/10 p-2 rounded transition-colors" data-event="click:editFavorite">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-400 hover:bg-red-400/10 p-2 rounded transition-colors" data-event="click:deleteFavorite">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-dark-bg rounded-lg p-4 border border-dark-border" data-mock="true">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h4 class="font-semibold" data-bind="favorite.name">Vendas</h4>
                                            <p class="text-sm text-gray-400 font-mono" data-bind="favorite.number">+5511888999777</p>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <button class="text-abmix-green hover:bg-abmix-green/10 p-2 rounded transition-colors" data-event="click:dialFavorite">
                                                <i class="fas fa-phone"></i>
                                            </button>
                                            <button class="text-blue-400 hover:bg-blue-400/10 p-2 rounded transition-colors" data-event="click:editFavorite">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-400 hover:bg-red-400/10 p-2 rounded transition-colors" data-event="click:deleteFavorite">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <!-- @END_MAP -->
                            </div>
                        </div>

                        <!-- @COMPONENT: Recordings -->
                        <div class="bg-dark-surface rounded-xl p-6 border border-dark-border">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Gravações</h3>
                                <div class="flex items-center space-x-2">
                                    <div class="w-3 h-3 bg-red-500 rounded-full opacity-0" id="recording-indicator"></div>
                                    <button class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm font-medium" data-event="click:toggleRecording" data-implementation="Should start/stop recording based on current state">
                                        <i class="fas fa-record-vinyl mr-2"></i>
                                        Iniciar Gravação
                                    </button>
                                </div>
                            </div>

                            <div class="text-sm text-gray-400">
                                <p>Nenhuma gravação ativa</p>
                                <!-- TODO: Lista de gravações salvas -->
                            </div>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="space-y-6">
                        
                        <!-- @COMPONENT: Transcripts -->
                        <div class="bg-dark-surface rounded-xl p-6 border border-dark-border h-full">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-semibold">Legendas (PT-BR)</h3>
                                <div class="flex items-center space-x-2">
                                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                    <span class="text-sm text-gray-400">Ativo</span>
                                </div>
                            </div>

                            <div class="space-y-4 max-h-96 overflow-y-auto" id="transcripts-container">
                                <!-- @STATE: transcripts:array = [] -->
                                <!-- @MAP: transcripts.map(transcript => ( -->
                                
                                <!-- Sample transcript entries for visualization -->
                                <div class="flex items-start space-x-3" data-mock="true">
                                    <div class="flex-shrink-0">
                                        <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center">
                                            <i class="fas fa-user text-xs"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center space-x-2 mb-1">
                                            <span class="text-sm font-medium text-blue-400" data-bind="transcript.speaker">Cliente</span>
                                            <span class="text-xs text-gray-500" data-bind="transcript.timestamp">14:23:15</span>
                                        </div>
                                        <p class="text-sm" data-bind="transcript.text">Olá, gostaria de saber sobre os seus planos de internet.</p>
                                    </div>
                                </div>

                                <div class="flex items-start space-x-3" data-mock="true">
                                    <div class="flex-shrink-0">
                                        <div class="w-8 h-8 rounded-full bg-abmix-green flex items-center justify-center">
                                            <i class="fas fa-robot text-black text-xs"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center space-x-2 mb-1">
                                            <span class="text-sm font-medium text-abmix-green" data-bind="transcript.speaker">IA</span>
                                            <span class="text-xs text-gray-500" data-bind="transcript.timestamp">14:23:18</span>
                                        </div>
                                        <p class="text-sm" data-bind="transcript.text">Olá! Claro, posso te ajudar com informações sobre nossos planos. Temos opções de 100MB, 200MB e 500MB. Qual seria a sua necessidade?</p>
                                    </div>
                                </div>

                                <div class="flex items-start space-x-3" data-mock="true">
                                    <div class="flex-shrink-0">
                                        <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center">
                                            <i class="fas fa-user text-xs"></i>
                                        </div>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center space-x-2 mb-1">
                                            <span class="text-sm font-medium text-blue-400" data-bind="transcript.speaker">Cliente</span>
                                            <span class="text-xs text-gray-500" data-bind="transcript.timestamp">14:23:25</span>
                                        </div>
                                        <p class="text-sm italic opacity-75" data-bind="transcript.text" data-partial="true">Preciso de algo mais rápido para trabalhar de casa...</p>
                                    </div>
                                </div>

                                <!-- @END_MAP -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- @END_COMPONENT: AppContainer -->

    <script>
        (function() {
            // @FUNCTIONALITY: Mock voice provider simulation for development testing
            let mockState = {
                callState: 'IDLE', // IDLE | RINGING | CONNECTED | ENDED
                aiActive: false,
                currentCallId: null,
                latency: 0,
                audioLevel: 0,
                transcripts: [],
                favorites: [
                    { id: 1, name: 'Suporte Técnico', number: '+5511999887766' },
                    { id: 2, name: 'Vendas', number: '+5511888999777' }
                ]
            };

            // TODO: Implement WebSocket connection for real-time events
            // TODO: Implement business logic for call management, AI controls, and transcript handling

            // Mock event simulation
            function simulateCallEvents() {
                if (mockState.callState === 'CONNECTED') {
                    // Simulate random audio level for visualization
                    mockState.audioLevel = Math.random() * 100;
                    const audioLevelEl = document.getElementById('audio-level');
                    if (audioLevelEl) {
                        audioLevelEl.style.width = mockState.audioLevel + '%';
                    }

                    // Simulate latency updates
                    mockState.latency = 45 + Math.random() * 20;
                    const latencyEl = document.querySelector('[data-bind="latency"]');
                    if (latencyEl) {
                        latencyEl.textContent = Math.round(mockState.latency) + ' ms';
                    }
                }
            }

            // Mock AI toggle functionality
            window.toggleAI = function() {
                mockState.aiActive = !mockState.aiActive;
                const toggle = document.getElementById('ai-toggle');
                const handle = document.getElementById('ai-toggle-handle');
                
                if (mockState.aiActive) {
                    handle.style.transform = 'translateX(1.5rem) translateY(0.125rem)';
                    handle.parentElement.classList.add('bg-abmix-green');
                    handle.parentElement.classList.remove('bg-dark-border');
                } else {
                    handle.style.transform = 'translateX(0.125rem) translateY(0.125rem)';
                    handle.parentElement.classList.remove('bg-abmix-green');
                    handle.parentElement.classList.add('bg-dark-border');
                }
            };

            // Update call status indicator
            function updateCallStatus() {
                const indicator = document.getElementById('status-indicator');
                const statusText = document.querySelector('[data-bind="callState"]');
                
                const statusConfig = {
                    'IDLE': { color: 'bg-gray-500', text: 'Idle', textClass: '' },
                    'RINGING': { color: 'bg-yellow-500', text: 'Chamando...', textClass: 'text-yellow-400' },
                    'CONNECTED': { color: 'bg-abmix-green', text: 'Conectado', textClass: 'text-abmix-green' },
                    'ENDED': { color: 'bg-red-500', text: 'Encerrada', textClass: 'text-red-400' }
                };

                const config = statusConfig[mockState.callState];
                if (indicator && statusText && config) {
                    indicator.className = `w-3 h-3 ${config.color} rounded-full`;
                    statusText.textContent = config.text;
                    statusText.className = `text-lg font-semibold ${config.textClass}`;
                }
            }

            // Initialize mock simulation
            setInterval(simulateCallEvents, 100);
            updateCallStatus();

            // Keyboard shortcuts for accessibility
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey) {
                    switch(e.key) {
                        case 'd':
                            e.preventDefault();
                            // TODO: Trigger dial function
                            console.log('Shortcut: Dial');
                            break;
                        case 'p':
                            e.preventDefault();
                            // TODO: Apply live prompt
                            console.log('Shortcut: Apply prompt');
                            break;
                        case 'h':
                            e.preventDefault();
                            // TODO: Hangup call
                            console.log('Shortcut: Hangup');
                            break;
                    }
                }
            });

            // TODO: Implement API service layer for REST endpoints
            // TODO: Implement state management (consider Zustand or Context API for React)
            // TODO: Implement form validation for E.164 format
            // TODO: Implement favorites CRUD operations
            // TODO: Implement recording functionality
            // TODO: Implement DTMF tone generation
            // TODO: Implement provider abstraction layer (Vapi/Retell/Twilio)

        })();
    </script>
</body>
</html>